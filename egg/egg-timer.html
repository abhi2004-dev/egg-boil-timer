<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Egg Timer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #ffcc00, #ff6b6b);
            padding: 20px;
            color: #333;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 500px;
            width: 100%;
        }
        
        h1 {
            margin-bottom: 20px;
            color: #ff6b6b;
            font-size: 2.5rem;
        }
        
        .egg-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .timer-display {
            font-size: 4rem;
            font-weight: bold;
            margin: 20px 0;
            color: #333;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #ffcc00;
        }
        
        .egg-info {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #ffcc00;
        }
        
        .egg-info h2 {
            color: #ff6b6b;
            margin-bottom: 10px;
        }
        
        .progress-container {
            width: 100%;
            background: #e9ecef;
            height: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #ffcc00, #ff6b6b);
            width: 0%;
            border-radius: 10px;
            transition: width 1s linear;
        }
        
        .status-message {
            margin: 15px 0;
            font-weight: bold;
            min-height: 24px;
            color: #ff6b6b;
        }
        
        .instructions {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: left;
        }
        
        .instructions h3 {
            color: #ff6b6b;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Perfect Egg Timer</h1>
        <div class="egg-icon">ðŸ¥š</div>
        
        <div class="egg-info">
            <h2 id="egg-type">Cooking: Medium Egg</h2>
            <p>Time remaining:</p>
        </div>
        
        <div class="timer-display" id="countdown">07:00</div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <div class="status-message" id="status">Timer is running...</div>
        
        <div class="instructions">
            <h3>Why this works correctly:</h3>
            <ul>
                <li>Audio will only play when the timer completes</li>
                <li>Touch/click events won't trigger audio early</li>
                <li>Progress bar shows time elapsed</li>
                <li>Clear status messages keep you informed</li>
            </ul>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Define the egg types and their times in seconds
            const eggTimes = {
                soft: 10,  // Reduced for testing - change to 240 for real soft eggs
                medium: 15, // Reduced for testing - change to 420 for real medium eggs
                hard: 20    // Reduced for testing - change to 720 for real hard eggs
            };
            
            // Get the type of egg from the URL parameters for demonstration
            // In a real scenario, you would get this from the current page URL
            const urlParams = new URLSearchParams(window.location.search);
            let eggType = urlParams.get('type') || 'medium';
            const totalTime = eggTimes[eggType];

            // Update the egg type display
            document.getElementById('egg-type').textContent = `Cooking: ${eggType.charAt(0).toUpperCase() + eggType.slice(1)} Egg`;

            // Timer variables
            let timeRemaining = totalTime;
            const countdownDisplay = document.getElementById("countdown");
            const progressBar = document.getElementById("progress-bar");
            const statusMessage = document.getElementById("status");
            let alarmSound = null;
            let timerId = null;
            let audioAllowed = false;

            // Function to update the timer display
            function updateDisplay() {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                countdownDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Update progress bar
                const progress = ((totalTime - timeRemaining) / totalTime) * 100;
                progressBar.style.width = `${progress}%`;
            }

            // Function to initialize audio
            function initAudio() {
                if (alarmSound) return;
                
                // Create audio element but don't play it
                alarmSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3');
                alarmSound.preload = 'auto';
                
                statusMessage.textContent = "Audio is ready - timer is running";
                audioAllowed = true;
            }

            // Function to play alarm sound
            function playAlarm() {
                if (alarmSound && audioAllowed) {
                    alarmSound.play()
                        .then(() => {
                            statusMessage.textContent = "Timer complete! Alarm is playing.";
                        })
                        .catch(error => {
                            console.error("Audio playback failed:", error);
                            statusMessage.textContent = "Timer complete! (Enable audio for alarm sound)";
                        });
                } else {
                    statusMessage.textContent = "Timer complete! (Audio was not enabled)";
                }
            }

            // Main timer function
            function startTimer() {
                if (timerId !== null) {
                    return; 
                }
                
                // Initialize audio on first user interaction
                if (!audioAllowed) {
                    statusMessage.textContent = "Click or touch anywhere to enable audio";
                    
                    const enableAudio = () => {
                        initAudio();
                        document.body.removeEventListener('click', enableAudio);
                        document.body.removeEventListener('touchstart', enableAudio);
                    };
                    
                    document.body.addEventListener('click', enableAudio);
                    document.body.addEventListener('touchstart', enableAudio);
                }
                
                // Start the countdown
                timerId = setInterval(() => {
                    if (timeRemaining <= 0) {
                        clearInterval(timerId);
                        countdownDisplay.textContent = "00:00";
                        progressBar.style.width = '100%';
                        playAlarm();
                    } else {
                        timeRemaining--;
                        updateDisplay();
                    }
                }, 1000);
            }
            
            // Initial setup
            updateDisplay();
            startTimer();
        });
    </script>
</body>
</html>